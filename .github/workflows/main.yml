name: CI/CD Workflow

on:
  push:
    branches:
      - main  

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2
        
      - name: Set Up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: 16 
        
      - name: Install Dependencies
        run: npm install
        
      - name: Run Unit Tests
        run: npm test

      - name: Send Teams Notification
        run: |
          curl -X POST -H "Content-Type: application/json" -d '{
              "title": "GitHub Actions Notification",
              "text": "Tu mensaje de notificación aquí."
            }' ${{ secrets.TEAMS_WEBHOOK }}


      #- name: Enviar correo electrónico en caso de fallo
       # if: ${{ failure() }}
       # uses: dawidd6/action-send-mail@v2.4.0
       # with:
        #  server_address: smtp.gmail.com
        #  server_port: 587
         # username: ${{ secrets.EMAIL_USERNAME }}
         # password: ${{ secrets.EMAIL_PASSWORD }}
         # subject: '[ERROR] La construcción ha fallado'
          #body: 'La construcción ha fallado. Por favor revisa el flujo de trabajo para más detalles.'
         # to: hanselpe02@gmail.com # Reemplaza esto con tu dirección de correo electrónico.
